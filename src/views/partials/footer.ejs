<link rel="stylesheet" type="text/css" href="/css/chatbot.css">


<footer class="bg-dark text-white py-5 mt-5">
    <!-- Chatbot Button -->
    <div id="chatbot-button" onclick="toggleChat()">
        üí¨ Chat
    </div>

    <!-- Chatbot Window -->
    <div id="chatbot-container">
        <div id="chatbot-header">
            <span>Chatbot</span>
            <button onclick="toggleChat()">√ó</button>
        </div>
        <div id="chatbot-messages"></div>
        <input type="text" id="chatbot-input" placeholder="Type a message..." onkeypress="sendMessage(event)">
    </div>
    
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h5>Our journey</h5>
                <p>From humble beginnings, we have built a community of loyal customers...</p>
            </div>
            <div class="col-md-4">
                <h5>Support</h5>
                <p>141 Xuan Thuy, Dich Vong Hau, Cau Giay, Ha Noi</p>
                <p>group11@gmail.com</p>
                <p>+843949505816</p>
            </div>
            <div class="col-md-4">
                <h5>Follow us</h5>
                <a href="#" class="text-white me-2"><i class="fa-brands fa-x-twitter fa-2x"></i></a>
                <a href="https://www.instagram.com/thah.lam7/" target="_blank" class="text-decoration-none">
                    <i class="fa fa-instagram fa-3x text-danger"></i>
                </a>
                <a href="https://www.facebook.com/thanhlamk4/" target="_blank" class="text-decoration-none">
                    <i class="fa fa-facebook-official fa-3x text-primary"></i>
                </a>
            </div>
        </div>
        <hr class="bg-white">
        <p class="text-center">¬© Copyright Group11 2025. All rights reserved</p>
    </div>
</footer>



<script>
    function toggleChat() {
        let chatbot = document.getElementById("chatbot-container");
        chatbot.style.display = chatbot.style.display === "none" || chatbot.style.display === "" ? "block" : "none";
    }

    async function sendMessage(event) {
        if (event.key === "Enter") {
            let input = document.getElementById("chatbot-input");
            let message = input.value.trim();
            if (message === "") return;

            let chatbox = document.getElementById("chatbot-messages");
            let userMessage = `<div><strong>You:</strong> ${message}</div>`;
            chatbox.innerHTML += userMessage;
            saveChatHistory();
            input.value = "";
            chatbox.scrollTop = chatbox.scrollHeight;

            try {
                let response = await fetch(`http://localhost:8000/api/chatbot?question=${encodeURIComponent(message)}`);
                let data = await response.json();
                
                let botReply = `<div><strong>Bot:</strong> ${data.response}</div>`;
                chatbox.innerHTML += botReply;
                saveChatHistory();
                chatbox.scrollTop = chatbox.scrollHeight;
            } catch (error) {
                console.error("Chatbot API error:", error);
                let errorMessage = `<div><strong>Bot:</strong> Xin l·ªói, hi·ªán t·∫°i t√¥i kh√¥ng th·ªÉ tr·∫£ l·ªùi.</div>`;
                chatbox.innerHTML += errorMessage;
                chatbox.scrollTop = chatbox.scrollHeight;
            }
        }
    }

    function saveChatHistory() {
        let chatbox = document.getElementById("chatbot-messages");
        localStorage.setItem("chatHistory", chatbox.innerHTML);
    }

    function loadChatHistory() {
        let chatbox = document.getElementById("chatbot-messages");
        let history = localStorage.getItem("chatHistory");
        if (history) {
            chatbox.innerHTML = history;
        }
    }

    document.addEventListener("DOMContentLoaded", loadChatHistory);
</script>